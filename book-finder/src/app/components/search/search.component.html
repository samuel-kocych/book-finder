<div class="container py-5">
  <header class="text-center mb-5">
    <h1 class="display-4 fw-bold text-primary mb-4">Book Finder</h1>

    <form
      class="mb-4"
      (submit)="onSearch(bookName.value, true); $event.preventDefault()"
    >
      <div class="row gx-2 align-items-center">
        <div class="col">
          <div class="input-group input-group-lg shadow rounded-pill">
            <input
              type="text"
              id="bookName"
              class="form-control border-0 rounded-pill-start"
              #bookName
              placeholder="Search for books..."
              aria-label="book search"
            />
            <button class="btn btn-primary rounded-pill-end px-4" type="submit">
              <i class="bi bi-search me-2"></i>Search
            </button>
          </div>
        </div>
        <div class="col-auto">
          <button
            class="btn btn-outline-secondary btn-lg fixed-width-button"
            type="button"
            (click)="showFilters = !showFilters"
          >
            {{ showFilters ? "Hide Filters" : "Show Filters" }}
          </button>
        </div>
      </div>

      <div class="row gy-3 gx-3 mt-3" *ngIf="showFilters">
        <div class="col-md-3">
          <label for="searchField" class="form-label">Search in</label>
          <select
            id="searchField"
            class="form-select"
            [(ngModel)]="searchField"
            name="searchField"
          >
            <option value="intitle">Title</option>
            <option value="inauthor">Author</option>
            <option value="subject">Category</option>
            <option value="inpublisher">Publisher</option>
            <option value="isbn">ISBN</option>
          </select>
        </div>

        <div class="col-md-3">
          <label for="language" class="form-label">Language</label>
          <select
            id="language"
            class="form-select"
            [(ngModel)]="language"
            name="language"
          >
            <option value="">All</option>
            <option value="en">English</option>
            <option value="cs">Czech</option>
            <option value="es">Spanish</option>
            <option value="fr">French</option>
            <option value="de">German</option>
            <option value="it">Italian</option>
            <option value="pt">Portuguese</option>
            <option value="ru">Russian</option>
            <option value="zh">Chinese</option>
            <option value="ja">Japanese</option>
            <option value="ko">Korean</option>
          </select>
        </div>

        <div class="col-md-3">
          <label for="availability" class="form-label">Availability</label>
          <select
            id="availability"
            class="form-select"
            [(ngModel)]="availability"
            name="availability"
          >
            <option value="all">All</option>
            <option value="free-ebooks">Free e-books</option>
            <option value="paid-ebooks">Paid e-books</option>
            <option value="ebooks">All e-books</option>
          </select>
        </div>

        <div class="col-md-3">
          <label for="orderBy" class="form-label">Sort by</label>
          <select
            id="orderBy"
            class="form-select"
            [(ngModel)]="orderBy"
            name="orderBy"
          >
            <option value="relevance">Relevance</option>
            <option value="newest">Newest</option>
          </select>
        </div>
      </div>
    </form>
  </header>

  <div *ngIf="!hasSearched">
    <div *ngIf="isFeaturedLoading" class="text-center my-5">
      <div class="spinner-border text-primary" role="status">
        <span class="visually-hidden">Loading...</span>
      </div>
    </div>
    <div *ngIf="!isFeaturedLoading && featuredBooks.length">
      <h2 class="mb-4 text-center text-primary">Featured books</h2>
      <div class="row row-cols-1 row-cols-md-2 row-cols-xl-3 g-4">
        <div class="col" *ngFor="let book of featuredBooks">
          <app-book-card [book]="book"></app-book-card>
        </div>
      </div>
    </div>
  </div>

  <div
    *ngIf="bookData.length"
    class="row row-cols-1 row-cols-md-2 row-cols-xl-3 g-4"
  >
    <div class="col" *ngFor="let book of bookData">
      <app-book-card [book]="book"></app-book-card>
    </div>
  </div>

  <ul
    class="pagination justify-content-center mt-4"
    *ngIf="hasSearched && bookData.length"
  >
    <li class="page-item" [class.disabled]="currentPage === 1">
      <a
        class="page-link"
        href="#"
        (click)="getPreviousPage(bookName.value); $event.preventDefault()"
        >Previous</a
      >
    </li>
    <li class="page-item">
      <span class="page-link">
        Page {{ currentPage }} of
        {{ Math.min(100, Math.ceil(totalResults / 10)) }}
      </span>
    </li>
    <li
      class="page-item"
      [class.disabled]="currentPage === Math.ceil(totalResults / 10)"
    >
      <a
        class="page-link"
        href="#"
        (click)="getNextPage(bookName.value); $event.preventDefault()"
        >Next</a
      >
    </li>
  </ul>

  <div
    *ngIf="hasSearched && !bookData.length"
    class="text-center py-5 text-muted"
  >
    <i class="bi bi-book display-5 mb-5 p-5"></i>
    <p class="lead">No books found. Try another search!</p>
  </div>
</div>
